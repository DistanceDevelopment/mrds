<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Double platform analysis • mrds</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Double platform analysis">
<meta name="description" content="Estimating g(0) comparing full and point independence models
">
<meta property="og:description" content="Estimating g(0) comparing full and point independence models
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mrds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/mrds-golftees.html">Point and full independence</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/mrds/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Double platform analysis</h1>
                        <h4 data-toc-skip class="author">Len Thomas</h4>
            <address class="author_afil">
      CREEM, Univ of St Andrews<br><h4 data-toc-skip class="date">November 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/mrds/blob/HEAD/vignettes/mrds-golftees.Rmd" class="external-link"><code>vignettes/mrds-golftees.Rmd</code></a></small>
      <div class="d-none name"><code>mrds-golftees.Rmd</code></div>
    </address>
</div>

    
    
<p>This example looks at mark-recapture distance sampling (MRDS) models. The first part of this exercise involves analysis of a survey of a known number of golf tees. This is intended mainly to familiarise you with the double-platform data structure and analysis features in the R function <code>mrds</code> <span class="citation">(Laake, Borchers, Thomas, Miller, &amp; Bishop, 2019)</span>.</p>
<p>To help understand the terminology using in MRDS and the output produced by <code>mrds</code>, there is a guide available <a href="Interpreting%20MRDS%20output.pdf">at this link</a> called <em>Interpreting MRDS output: making sense of all the numbers</em>.</p>
<div class="section level2">
<h2 id="aims">Aims<a class="anchor" aria-label="anchor" href="#aims"></a>
</h2>
<p>The aims of this practical are to learn how to model</p>
<ul>
<li>trial and independent-observer configuration</li>
<li>full and point independence assumptions,</li>
<li>include covariates in the detection function(s) and</li>
<li>select between competing models.</li>
</ul>
<div class="section level3">
<h3 id="golf-tee-data">Golf tee data<a class="anchor" aria-label="anchor" href="#golf-tee-data"></a>
</h3>
<p>These data come from a survey of golf tees which conducted by statistics students at the University of St Andrews. The data were collected along transect lines, 210 metres in total. A distance of 4 metres out from the centre line was searched and, for the purposes of this exercise, we assume that this comprised the total study area, which was divided into two strata. There were 250 clusters of tees in total and 760 individual tees in total.</p>
<p>The population was independently surveyed by two observer teams. The following data were recorded for each detected group: perpendicular distance, cluster size, observer (team 1 or 2), ‘sex’ (males are yellow and females are green and golf tees occur in single-sex clusters) and ‘exposure’. Exposure was a subjective judgment of whether the cluster was substantially obscured by grass (exposure=0) or not (exposure=1). The lengths of grass varied along the transect line and the grass was slightly more yellow along one part of the line compared to the rest.</p>
<p>The golf tee dataset is provided as part of the <code>mrds</code> package.</p>
<p>Open R and load the <code>mrds</code> package and golf tee dataset (called <code>book.tee.data</code>). The elements required for an MRDS analysis are contained within the object dataset. These data are in a hierarchical structure (rather than in a ‘flat file’ format) so that there are separate elements for observations, samples and regions. In the code below, each of these tables is extracted to avoid typing long names.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DistanceDevelopment/mrds/" class="external-link">mrds</a></span><span class="op">)</span></span>
<span><span class="co"># Access the golf tee data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">book.tee.data</span><span class="op">)</span></span>
<span><span class="co"># Investigate the structure of the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">book.tee.data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 4</span></span>
<span><span class="co">##  $ book.tee.dataframe:'data.frame':  324 obs. of  7 variables:</span></span>
<span><span class="co">##   ..$ object  : num [1:324] 1 1 2 2 3 3 4 4 5 5 ...</span></span>
<span><span class="co">##   ..$ observer: Factor w/ 2 levels "1","2": 1 2 1 2 1 2 1 2 1 2 ...</span></span>
<span><span class="co">##   ..$ detected: num [1:324] 1 0 1 0 1 0 1 0 1 0 ...</span></span>
<span><span class="co">##   ..$ distance: num [1:324] 2.68 2.68 3.33 3.33 0.34 0.34 2.53 2.53 1.46 1.46 ...</span></span>
<span><span class="co">##   ..$ size    : num [1:324] 2 2 2 2 1 1 2 2 2 2 ...</span></span>
<span><span class="co">##   ..$ sex     : num [1:324] 1 1 1 1 0 0 1 1 1 1 ...</span></span>
<span><span class="co">##   ..$ exposure: num [1:324] 1 1 0 0 0 0 1 1 0 0 ...</span></span>
<span><span class="co">##  $ book.tee.region   :'data.frame':  2 obs. of  2 variables:</span></span>
<span><span class="co">##   ..$ Region.Label: Factor w/ 2 levels "1","2": 1 2</span></span>
<span><span class="co">##   ..$ Area        : num [1:2] 1040 640</span></span>
<span><span class="co">##  $ book.tee.samples  :'data.frame':  11 obs. of  3 variables:</span></span>
<span><span class="co">##   ..$ Sample.Label: num [1:11] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##   ..$ Region.Label: Factor w/ 2 levels "1","2": 1 1 1 1 1 1 2 2 2 2 ...</span></span>
<span><span class="co">##   ..$ Effort      : num [1:11] 10 30 30 27 21 12 23 23 15 12 ...</span></span>
<span><span class="co">##  $ book.tee.obs      :'data.frame':  162 obs. of  3 variables:</span></span>
<span><span class="co">##   ..$ object      : int [1:162] 1 2 3 21 22 23 24 59 60 61 ...</span></span>
<span><span class="co">##   ..$ Region.Label: int [1:162] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##   ..$ Sample.Label: int [1:162] 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the list elements from the dataset into easy-to-access objects</span></span>
<span><span class="va">detections</span> <span class="op">&lt;-</span> <span class="va">book.tee.data</span><span class="op">$</span><span class="va">book.tee.dataframe</span> <span class="co"># detection information</span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="va">book.tee.data</span><span class="op">$</span><span class="va">book.tee.region</span> <span class="co"># region info</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">book.tee.data</span><span class="op">$</span><span class="va">book.tee.samples</span> <span class="co"># transect info</span></span>
<span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="va">book.tee.data</span><span class="op">$</span><span class="va">book.tee.obs</span> <span class="co"># links detections to transects and regions</span></span></code></pre></div>
<p>Examine the columns in the <code>detections</code> data because it has a particular structure.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check detections</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">detections</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    object observer detected distance size sex exposure</span></span>
<span><span class="co">## 1       1        1        1     2.68    2   1        1</span></span>
<span><span class="co">## 21      1        2        0     2.68    2   1        1</span></span>
<span><span class="co">## 2       2        1        1     3.33    2   1        0</span></span>
<span><span class="co">## 22      2        2        0     3.33    2   1        0</span></span>
<span><span class="co">## 3       3        1        1     0.34    1   0        0</span></span>
<span><span class="co">## 23      3        2        0     0.34    1   0        0</span></span></code></pre>
<p>The structure of the detection is as follows:</p>
<ul>
<li>each detected object (in this case the object was a group or cluster of golf tees) is given a unique number in the <code>object</code> column,</li>
<li>each <code>object</code> occurs twice - once for observer 1 and once for observer 2,</li>
<li>the <code>detected</code> column indicates whether the object was seen (<code>detected=1</code>) or not seen (<code>detected=0</code>) by the observer,</li>
<li>perpendicular distance is in the <code>distance</code> column and cluster size is in the <code>size</code> column (the same default names as for the <code>ds</code> function).</li>
</ul>
<p>To ensure that the variables <code>sex</code> and <code>exposure</code> are treated correctly, define them as factor variables.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define sex and exposure as factor variables </span></span>
<span><span class="va">detections</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">detections</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="va">detections</span><span class="op">$</span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">detections</span><span class="op">$</span><span class="va">exposure</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="golf-tee-survey-analyses">Golf tee survey analyses<a class="anchor" aria-label="anchor" href="#golf-tee-survey-analyses"></a>
</h3>
<div class="section level4">
<h4 id="estimation-of-p0-distance-only">Estimation of <em>p(0)</em>: distance only<a class="anchor" aria-label="anchor" href="#estimation-of-p0-distance-only"></a>
</h4>
<p>We will start by analysing these data assuming that Observer 2 was generating trials for Observer 1 but not vice versa, i.e. trial configuration where Observer 1 is the primary and Observer 2 is the tracker. (The data could also be analysed in independent observer configuration - you are welcome to try this for yourself). We begin by assuming full independence (i.e. detections between observers are independent at all distances): this requires only a mark-recapture (MR) model and, to start with, perpendicular distance will be included as the only covariate.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit trial configuration with full independence model</span></span>
<span><span class="va">fi.mr.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.html">ddf</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'trial.fi'</span>, mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'logit'</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">distance</span><span class="op">)</span>,</span>
<span>                  data<span class="op">=</span><span class="va">detections</span>, meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="examining-mrds-output">Examining <code>mrds</code> output<a class="anchor" aria-label="anchor" href="#examining-mrds-output"></a>
</h5>
<p>Having fitted the model, we can create tables summarizing the detection data. In the commands below, the tables are created using the <code>det.tables</code> function and saved to <code>detection.tables</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a set of tables summarizing the double observer data </span></span>
<span><span class="va">detection.tables</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/det.tables.html">det.tables</a></span><span class="op">(</span><span class="va">fi.mr.dist</span><span class="op">)</span></span>
<span><span class="co"># Print these detection tables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">detection.tables</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Observer 1 detections</span></span>
<span><span class="co">##            Detected</span></span>
<span><span class="co">##             Missed Detected</span></span>
<span><span class="co">##   [0,0.4]        1       25</span></span>
<span><span class="co">##   (0.4,0.8]      2       16</span></span>
<span><span class="co">##   (0.8,1.2]      2       16</span></span>
<span><span class="co">##   (1.2,1.6]      6       22</span></span>
<span><span class="co">##   (1.6,2]        5        9</span></span>
<span><span class="co">##   (2,2.4]        2       10</span></span>
<span><span class="co">##   (2.4,2.8]      6       12</span></span>
<span><span class="co">##   (2.8,3.2]      6        9</span></span>
<span><span class="co">##   (3.2,3.6]      2        3</span></span>
<span><span class="co">##   (3.6,4]        6        2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Observer 2 detections</span></span>
<span><span class="co">##            Detected</span></span>
<span><span class="co">##             Missed Detected</span></span>
<span><span class="co">##   [0,0.4]        4       22</span></span>
<span><span class="co">##   (0.4,0.8]      1       17</span></span>
<span><span class="co">##   (0.8,1.2]      0       18</span></span>
<span><span class="co">##   (1.2,1.6]      2       26</span></span>
<span><span class="co">##   (1.6,2]        1       13</span></span>
<span><span class="co">##   (2,2.4]        2       10</span></span>
<span><span class="co">##   (2.4,2.8]      3       15</span></span>
<span><span class="co">##   (2.8,3.2]      4       11</span></span>
<span><span class="co">##   (3.2,3.6]      2        3</span></span>
<span><span class="co">##   (3.6,4]        1        7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Duplicate detections</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   [0,0.4] (0.4,0.8] (0.8,1.2] (1.2,1.6]   (1.6,2]   (2,2.4] (2.4,2.8] (2.8,3.2] </span></span>
<span><span class="co">##        21        15        16        20         8         8         9         5 </span></span>
<span><span class="co">## (3.2,3.6]   (3.6,4] </span></span>
<span><span class="co">##         1         1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Observer 1 detections of those seen by Observer 2</span></span>
<span><span class="co">##           Missed Detected Prop. detected</span></span>
<span><span class="co">## [0,0.4]        1       21      0.9545455</span></span>
<span><span class="co">## (0.4,0.8]      2       15      0.8823529</span></span>
<span><span class="co">## (0.8,1.2]      2       16      0.8888889</span></span>
<span><span class="co">## (1.2,1.6]      6       20      0.7692308</span></span>
<span><span class="co">## (1.6,2]        5        8      0.6153846</span></span>
<span><span class="co">## (2,2.4]        2        8      0.8000000</span></span>
<span><span class="co">## (2.4,2.8]      6        9      0.6000000</span></span>
<span><span class="co">## (2.8,3.2]      6        5      0.4545455</span></span>
<span><span class="co">## (3.2,3.6]      2        1      0.3333333</span></span>
<span><span class="co">## (3.6,4]        6        1      0.1428571</span></span></code></pre>
<p>The information in detection summary tables can be plotted, but, in the interest of space, only one (out of six possible plots) is shown (Figure <a href="#fig:dettabplot">1</a>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot detection information, change number to see other plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">detection.tables</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:dettabplot"></span>
<img src="mrds-golftees_files/figure-html/dettabplot-1.png" alt="Detection distances for observer 1"><p class="caption">
Figure 1: Detection distances for observer 1
</p>
</div>
<p>The plot numbers are:</p>
<ol style="list-style-type: decimal">
<li>Histograms of distances for detections by either, or both, observers. The shaded regions show the number for observer 1.</li>
<li>Histograms of distances for detections by either, or both, observers. The shaded regions show the number for observer 2.</li>
<li>Histograms of distances for duplicates (detected by both observers).</li>
<li>Histogram of distances for detections by either, or both, observers. Not shown for trial configuration.</li>
<li>Histograms of distances for observer 2. The shaded regions indicate the number of duplicates - for example, the shaded region is the number of clusters in each distance bin that were detected by Observer 1 given that they were also detected by Observer 2 (the “|” symbol in the plot legend means “given that”).</li>
<li>Histograms of distances for observer 1. The shaded regions indicate the number of duplicates as for plot 5. Not shown for trial configuration.</li>
</ol>
<p>Note that if an independent observer configuration had been chosen, all plots would be available.</p>
<p>A summary of the detection function model is available using the <code>summary</code> function. The Q-Q plot has the same interpretation as a Q-Q plot in a conventional, single platform analysis (Figure <a href="#fig:fisummary">2</a>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Produce a summary of the fitted detection function object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fi.mr.dist</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary for trial.fi object </span></span>
<span><span class="co">## Number of observations               :  162 </span></span>
<span><span class="co">## Number seen by primary               :  124 </span></span>
<span><span class="co">## Number seen by secondary (trials)    :  142 </span></span>
<span><span class="co">## Number seen by both (detected trials):  104 </span></span>
<span><span class="co">## AIC                                  :  452.8094 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Conditional detection function parameters:</span></span>
<span><span class="co">##              estimate        se</span></span>
<span><span class="co">## (Intercept)  2.900233 0.4876238</span></span>
<span><span class="co">## distance    -1.058677 0.2235722</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                         Estimate          SE         CV</span></span>
<span><span class="co">## Average p              0.6423252  0.04069410 0.06335435</span></span>
<span><span class="co">## Average primary p(0)   0.9478579  0.06109656 0.06445750</span></span>
<span><span class="co">## N in covered region  193.0486185 15.84826582 0.08209469</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Produce goodness of fit statistics and a qq plot</span></span>
<span><span class="va">gof.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.gof.html">ddf.gof</a></span><span class="op">(</span><span class="va">fi.mr.dist</span>, </span>
<span>                      main<span class="op">=</span><span class="st">"Full independence, trial configuration\ngoodness of fit Golf tee data"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:fisummary"></span>
<img src="mrds-golftees_files/figure-html/fisummary-1.png" alt="Fitted detection function for full independence, trial mode."><p class="caption">
Figure 2: Fitted detection function for full independence, trial mode.
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract chi-square statistics for reporting</span></span>
<span><span class="va">chi.distance</span> <span class="op">&lt;-</span> <span class="va">gof.result</span><span class="op">$</span><span class="va">chisquare</span><span class="op">$</span><span class="va">chi1</span><span class="op">$</span><span class="va">chisq</span></span>
<span><span class="va">chi.markrecap</span> <span class="op">&lt;-</span> <span class="va">gof.result</span><span class="op">$</span><span class="va">chisquare</span><span class="op">$</span><span class="va">chi2</span><span class="op">$</span><span class="va">chisq</span></span>
<span><span class="va">chi.total</span> <span class="op">&lt;-</span> <span class="va">gof.result</span><span class="op">$</span><span class="va">chisquare</span><span class="op">$</span><span class="va">pooled.chi</span></span></code></pre></div>
<p>Abbreviated <span class="math inline">\(\chi^2\)</span> goodness-of-fit assessment shows the <span class="math inline">\(\chi^2\)</span> contribution from the distance sampling model to be 11.5 and the <span class="math inline">\(\chi^2\)</span> contribution from the mark-recapture model to be 3.4. The combination of these elements produces a total <span class="math inline">\(\chi^2\)</span> of 14.9 with 17 degrees of freedom, resulting in a <span class="math inline">\(p\)</span>-value of 0.604</p>
<p>The (two) detection functions can be plotted (Figure <a href="#fig:plotdf">3</a>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Plot detection functions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fi.mr.dist</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:plotdf"></span>
<img src="mrds-golftees_files/figure-html/plotdf-1.png" alt="Observer 1 detection function (left) and conditional detection probabilty plot (right)."><p class="caption">
Figure 3: Observer 1 detection function (left) and conditional detection probabilty plot (right).
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The plot labelled</p>
<ul>
<li>“Observer=1 detections” shows a histogram of Observer 1 detections with the estimated Observer 1 detection function overlaid on it and adjusted for <em>p(0)</em>. The dots show the estimated detection probability for all Observer 1 detections.</li>
<li>“Conditional detection probability” shows the proportion of Obs 2’s detections that were detected by Obs 1 (also see the detection tables). The fitted line is the estimated detection probability function for Obs 1 (given detection by Obs 2) - this is the MR model. Dots are estimated detection probabilities for each Obs 1 detection.</li>
</ul>
<p>There is some evidence of unmodelled heterogeneity in that the fitted line in the left-hand plot declines more slowly than the histogram as the distance increases.</p>
</div>
<div class="section level5">
<h5 id="estimating-abundance">Estimating abundance<a class="anchor" aria-label="anchor" href="#estimating-abundance"></a>
</h5>
<p>Abundance is estimated using the <code>dht</code> function. In this function, we need to supply information about the transects and survey regions.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate density estimates using the dht function</span></span>
<span><span class="va">tee.abund</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dht.html">dht</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">fi.mr.dist</span>, region.table<span class="op">=</span><span class="va">region</span>, sample.table<span class="op">=</span><span class="va">samples</span>, obs.table<span class="op">=</span><span class="va">obs</span><span class="op">)</span></span>
<span><span class="co"># Print out results in a nice format</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tee.abund</span><span class="op">$</span><span class="va">individuals</span><span class="op">$</span><span class="va">summary</span>, digits<span class="op">=</span><span class="fl">2</span>, </span>
<span>      caption<span class="op">=</span><span class="st">"Survey summary statistics for golftees"</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>
<span id="tab:abund-from-dist">Table 1: </span>Survey summary statistics for golftees</caption>
<colgroup>
<col width="9%">
<col width="6%">
<col width="16%">
<col width="9%">
<col width="5%">
<col width="4%">
<col width="6%">
<col width="8%">
<col width="8%">
<col width="13%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Region</th>
<th align="right">Area</th>
<th align="right">CoveredArea</th>
<th align="right">Effort</th>
<th align="right">n</th>
<th align="right">k</th>
<th align="right">ER</th>
<th align="right">se.ER</th>
<th align="right">cv.ER</th>
<th align="right">mean.size</th>
<th align="right">se.mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">1040</td>
<td align="right">1040</td>
<td align="right">130</td>
<td align="right">229</td>
<td align="right">6</td>
<td align="right">1.76</td>
<td align="right">0.12</td>
<td align="right">0.07</td>
<td align="right">3.18</td>
<td align="right">0.21</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">640</td>
<td align="right">640</td>
<td align="right">80</td>
<td align="right">152</td>
<td align="right">5</td>
<td align="right">1.90</td>
<td align="right">0.33</td>
<td align="right">0.18</td>
<td align="right">2.92</td>
<td align="right">0.23</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">1680</td>
<td align="right">1680</td>
<td align="right">210</td>
<td align="right">381</td>
<td align="right">11</td>
<td align="right">1.81</td>
<td align="right">0.15</td>
<td align="right">0.08</td>
<td align="right">3.07</td>
<td align="right">0.15</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tee.abund</span><span class="op">$</span><span class="va">individuals</span><span class="op">$</span><span class="va">N</span>, digits<span class="op">=</span><span class="fl">2</span>, </span>
<span>      caption<span class="op">=</span><span class="st">"Abundance estimates for golftee population with two strata"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:abund-from-dist">Table 1: </span>Abundance estimates for golftee population with two strata</caption>
<thead><tr class="header">
<th align="left">Label</th>
<th align="right">Estimate</th>
<th align="right">se</th>
<th align="right">cv</th>
<th align="right">lcl</th>
<th align="right">ucl</th>
<th align="right">df</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">356.52</td>
<td align="right">32.35</td>
<td align="right">0.09</td>
<td align="right">294.54</td>
<td align="right">431.53</td>
<td align="right">17.13</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">236.64</td>
<td align="right">44.14</td>
<td align="right">0.19</td>
<td align="right">147.33</td>
<td align="right">380.09</td>
<td align="right">5.06</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="right">593.16</td>
<td align="right">60.38</td>
<td align="right">0.10</td>
<td align="right">478.32</td>
<td align="right">735.57</td>
<td align="right">16.06</td>
</tr>
</tbody>
</table>
<p>The estimated abundance is 593 (recall that the true abundance is 760) and so this estimate is negatively biased. The 95% confidence interval does not include the true value.</p>
</div>
</div>
<div class="section level4">
<h4 id="estimation-of-p0-distance-and-other-explanatory-variables">Estimation of <em>p(0)</em>: distance and other explanatory variables<a class="anchor" aria-label="anchor" href="#estimation-of-p0-distance-and-other-explanatory-variables"></a>
</h4>
<p>How about including the other covariates, <code>size</code>, <code>sex</code> and <code>exposure</code>, in the MR model? Which MR model would you use? In the command below, <code>distance</code> and <code>sex</code> are included in the detection function - remember <code>sex</code> was defined as a factor earlier on.</p>
<p>In the code below, all possible models (excluding interaction terms) are fitted.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Full independence model</span></span>
<span><span class="co"># Set up list with possible models</span></span>
<span><span class="va">mr.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~distance"</span>,<span class="st">"~distance+size"</span>,<span class="st">"~distance+sex"</span>,<span class="st">"~distance+exposure"</span>,</span>
<span>                <span class="st">"~distance+size+sex"</span>,<span class="st">"~distance+size+exposure"</span>,<span class="st">"~distance+sex+exposure"</span>,</span>
<span>                <span class="st">"~distance+size+sex+exposure"</span><span class="op">)</span></span>
<span><span class="va">num.mr.models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mr.formula</span><span class="op">)</span></span>
<span><span class="co"># Create dataframe to store results</span></span>
<span><span class="va">fi.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>MRmodel<span class="op">=</span><span class="va">mr.formula</span>, AIC<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">num.mr.models</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Loop through all MR models</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num.mr.models</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fi.model</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.html">ddf</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'trial.fi'</span>, </span>
<span>                   mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'logit'</span>,formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="va">mr.formula</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  data<span class="op">=</span><span class="va">detections</span>, meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">fi.results</span><span class="op">$</span><span class="va">AIC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fi.model</span><span class="op">)</span><span class="op">$</span><span class="va">aic</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Calculate delta AIC</span></span>
<span><span class="va">fi.results</span><span class="op">$</span><span class="va">deltaAIC</span> <span class="op">&lt;-</span> <span class="va">fi.results</span><span class="op">$</span><span class="va">AIC</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fi.results</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span></span>
<span><span class="co"># Order by delta AIC</span></span>
<span><span class="va">fi.results</span> <span class="op">&lt;-</span> <span class="va">fi.results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">fi.results</span><span class="op">$</span><span class="va">deltaAIC</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co"># Print results in pretty way</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">fi.results</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">MRmodel</th>
<th align="right">AIC</th>
<th align="right">deltaAIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">7</td>
<td align="left">~distance+sex+exposure</td>
<td align="right">405.68</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">~distance+size+sex+exposure</td>
<td align="right">407.40</td>
<td align="right">1.72</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">~distance+exposure</td>
<td align="right">433.72</td>
<td align="right">28.04</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">~distance+sex</td>
<td align="right">434.41</td>
<td align="right">28.74</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">~distance+size+exposure</td>
<td align="right">435.33</td>
<td align="right">29.65</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">~distance+size+sex</td>
<td align="right">436.02</td>
<td align="right">30.34</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">~distance</td>
<td align="right">452.81</td>
<td align="right">47.13</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">~distance+size</td>
<td align="right">454.58</td>
<td align="right">48.91</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit chosen model</span></span>
<span><span class="va">fi.mr.dist.sex.exp</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.html">ddf</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'trial.fi'</span>, mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'logit'</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">distance</span><span class="op">+</span><span class="va">sex</span><span class="op">+</span><span class="va">exposure</span><span class="op">)</span>,</span>
<span>                           data<span class="op">=</span><span class="va">detections</span>, meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We see that the preferred model contains <code>distance + sex + exposure</code> so check the goodness-of-fit statistics (Figure <a href="#fig:bestfi">4</a>) and detection function plots (Figure <a href="#fig:fidetfn">5</a>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check goodness-of-fit </span></span>
<span><span class="fu"><a href="../reference/ddf.gof.html">ddf.gof</a></span><span class="op">(</span><span class="va">fi.mr.dist.sex.exp</span>, main<span class="op">=</span><span class="st">"FI trial mode\nMR=dist+sex+exp"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:bestfi"></span>
<img src="mrds-golftees_files/figure-html/bestfi-1.png" alt="Preferred model goodness of fit."><p class="caption">
Figure 4: Preferred model goodness of fit.
</p>
</div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Goodness of fit results for ddf object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Chi-square tests</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling component:</span></span>
<span><span class="co">##           [0,0.4] (0.4,0.8] (0.8,1.2] (1.2,1.6] (1.6,2] (2,2.4] (2.4,2.8]</span></span>
<span><span class="co">## Observed   25.000    16.000    16.000    22.000   9.000  10.000    12.000</span></span>
<span><span class="co">## Expected   20.276    19.341    18.074    16.345  14.083  11.511     9.046</span></span>
<span><span class="co">## Chisquare   1.101     0.577     0.238     1.957   1.834   0.198     0.964</span></span>
<span><span class="co">##           (2.8,3.2] (3.2,3.6] (3.6,4]   Total</span></span>
<span><span class="co">## Observed      9.000     3.000   2.000 124.000</span></span>
<span><span class="co">## Expected      6.915     5.044   3.366 124.000</span></span>
<span><span class="co">## Chisquare     0.629     0.828   0.554   8.881</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## No degrees of freedom for test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mark-recapture component:</span></span>
<span><span class="co">## Capture History 01</span></span>
<span><span class="co">##           [0,0.4] (0.4,0.8] (0.8,1.2] (1.2,1.6] (1.6,2] (2,2.4] (2.4,2.8]</span></span>
<span><span class="co">## Observed        1         2         2         6       5       2         6</span></span>
<span><span class="co">## Expected        1         2         2         6       4       4         6</span></span>
<span><span class="co">## Chisquare       0         0         0         0       0       1         0</span></span>
<span><span class="co">##           (2.8,3.2] (3.2,3.6] (3.6,4] Total</span></span>
<span><span class="co">## Observed          6         2       6    38</span></span>
<span><span class="co">## Expected          7         2       5    38</span></span>
<span><span class="co">## Chisquare         0         0       0     2</span></span>
<span><span class="co">## Capture History 11</span></span>
<span><span class="co">##           [0,0.4] (0.4,0.8] (0.8,1.2] (1.2,1.6] (1.6,2] (2,2.4] (2.4,2.8]</span></span>
<span><span class="co">## Observed       21        15        16        20       8       8         9</span></span>
<span><span class="co">## Expected       21        15        16        20       9       6         9</span></span>
<span><span class="co">## Chisquare       0         0         0         0       0       1         0</span></span>
<span><span class="co">##           (2.8,3.2] (3.2,3.6] (3.6,4] Total</span></span>
<span><span class="co">## Observed          5         1       1   104</span></span>
<span><span class="co">## Expected          4         1       2   104</span></span>
<span><span class="co">## Chisquare         0         0       1     2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Total chi-square = 12.205  P = 0.66344 with 15 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling Cramer-von Mises test (unweighted)</span></span>
<span><span class="co">## Test statistic = 0.0976947 p-value = 0.596294</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fi.mr.dist.sex.exp</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:fidetfn"></span>
<img src="mrds-golftees_files/figure-html/fidetfn-1.png" alt="Detection functions for full independence model with distance, sex and exposure in MR component."><p class="caption">
Figure 5: Detection functions for full independence model with distance, sex and exposure in MR component.
</p>
</div>
<p>And produce abundance estimates.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get abundance estimates </span></span>
<span><span class="va">tee.abund.fi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dht.html">dht</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">fi.mr.dist.sex.exp</span>, region.table<span class="op">=</span><span class="va">region</span>,</span>
<span>                    sample.table<span class="op">=</span><span class="va">samples</span>, obs.table<span class="op">=</span><span class="va">obs</span><span class="op">)</span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tee.abund.fi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Abundance and density estimates from distance sampling</span></span>
<span><span class="co">## Variance       : R2, N/L </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary statistics</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Region Area CoveredArea Effort   n  k        ER      se.ER      cv.ER</span></span>
<span><span class="co">## 1      1 1040        1040    130  72  6 0.5538462 0.02926903 0.05284685</span></span>
<span><span class="co">## 2      2  640         640     80  52  5 0.6500000 0.08292740 0.12758061</span></span>
<span><span class="co">## 3  Total 1680        1680    210 124 11 0.5904762 0.03641856 0.06167659</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for clusters</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Abundance:</span></span>
<span><span class="co">##   Region  Estimate       se        cv       lcl      ucl       df</span></span>
<span><span class="co">## 1      1 119.28976 14.18666 0.1189260  91.64685 155.2704 10.12494</span></span>
<span><span class="co">## 2      2  98.17731 18.59356 0.1893876  63.58200 151.5961  7.83844</span></span>
<span><span class="co">## 3  Total 217.46707 26.05226 0.1197987 169.90391 278.3451 23.21368</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##   Region  Estimate         se        cv        lcl       ucl       df</span></span>
<span><span class="co">## 1      1 0.1147017 0.01364102 0.1189260 0.08812198 0.1492985 10.12494</span></span>
<span><span class="co">## 2      2 0.1534020 0.02905244 0.1893876 0.09934687 0.2368689  7.83844</span></span>
<span><span class="co">## 3  Total 0.1294447 0.01550730 0.1197987 0.10113328 0.1656816 23.21368</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for individuals</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Abundance:</span></span>
<span><span class="co">##   Region Estimate       se        cv      lcl      ucl        df</span></span>
<span><span class="co">## 1      1 371.0397 37.86856 0.1020607 297.1733 463.2666 11.904084</span></span>
<span><span class="co">## 2      2 279.7141 67.25221 0.2404320 154.4960 506.4208  5.482654</span></span>
<span><span class="co">## 3  Total 650.7538 82.72649 0.1271241 493.7469 857.6875 11.907393</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##   Region  Estimate         se        cv       lcl       ucl        df</span></span>
<span><span class="co">## 1      1 0.3567690 0.03641208 0.1020607 0.2857436 0.4454487 11.904084</span></span>
<span><span class="co">## 2      2 0.4370533 0.10508158 0.2404320 0.2414000 0.7912825  5.482654</span></span>
<span><span class="co">## 3  Total 0.3873535 0.04924196 0.1271241 0.2938970 0.5105283 11.907393</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Expected cluster size</span></span>
<span><span class="co">##   Region Expected.S se.Expected.S cv.Expected.S</span></span>
<span><span class="co">## 1      1   3.110407     0.2740170    0.08809682</span></span>
<span><span class="co">## 2      2   2.849071     0.2211204    0.07761141</span></span>
<span><span class="co">## 3  Total   2.992425     0.1758058    0.05875027</span></span></code></pre>
<p>This model incorporates the effect of more variables causing the heterogeneity. The estimated abundance is 651 which is less biased than the previous estimate and the 95% confidence interval (494, 858) contains the true value.</p>
<p>The model is a reasonable fit to the data (i.e. non-significant <span class="math inline">\(\chi^2\)</span> and Cramer von Mises tests). This model has a lower AIC (405.7) than the model with only distance (452.81) and so is to be preferred.</p>
</div>
<div class="section level4">
<h4 id="point-independence">Point independence<a class="anchor" aria-label="anchor" href="#point-independence"></a>
</h4>
<p>A less restrictive assumption than full independence is point independence, which assumes that detections are only independent on the transect centre line i.e. at perpendicular distance zero <span class="citation">(Buckland, Laake, &amp; Borchers, 2010)</span>.</p>
<p>Determine if a simple point independence model is better than a simple full independence one. This requires that a distance sampling (DS) model is specified as well a MR model. Here we try a half-normal key function for the DS model (Figure <a href="#fig:pit-nocovar">6</a>).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit trial configuration with point independence model</span></span>
<span><span class="va">pi.mr.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.html">ddf</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'trial'</span>, </span>
<span>                  mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'logit'</span>, formula<span class="op">=</span><span class="op">~</span><span class="va">distance</span><span class="op">)</span>,</span>
<span>                  dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="../reference/cds.html">cds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">'hn'</span><span class="op">)</span>, </span>
<span>                  data<span class="op">=</span><span class="va">detections</span>, meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Summary pf the model </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pi.mr.dist</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary for trial.fi object </span></span>
<span><span class="co">## Number of observations               :  162 </span></span>
<span><span class="co">## Number seen by primary               :  124 </span></span>
<span><span class="co">## Number seen by secondary (trials)    :  142 </span></span>
<span><span class="co">## Number seen by both (detected trials):  104 </span></span>
<span><span class="co">## AIC                                  :  140.8887 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Conditional detection function parameters:</span></span>
<span><span class="co">##              estimate        se</span></span>
<span><span class="co">## (Intercept)  2.900233 0.4876238</span></span>
<span><span class="co">## distance    -1.058677 0.2235722</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                       Estimate         SE         CV</span></span>
<span><span class="co">## Average primary p(0) 0.9478579 0.02409996 0.02542571</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for ds object</span></span>
<span><span class="co">## Number of observations :  124 </span></span>
<span><span class="co">## Distance range         :  0  -  4 </span></span>
<span><span class="co">## AIC                    :  311.1385 </span></span>
<span><span class="co">## Optimisation           :  mrds (nlminb) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection function:</span></span>
<span><span class="co">##  Half-normal key function </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection function parameters </span></span>
<span><span class="co">## Scale coefficient(s): </span></span>
<span><span class="co">##              estimate         se</span></span>
<span><span class="co">## (Intercept) 0.6632435 0.09981249</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##            Estimate         SE         CV</span></span>
<span><span class="co">## Average p 0.5842744 0.04637627 0.07937412</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for trial object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Total AIC value =  452.0272 </span></span>
<span><span class="co">##                        Estimate          SE         CV</span></span>
<span><span class="co">## Average p             0.5538091  0.04615832 0.08334697</span></span>
<span><span class="co">## N in covered region 223.9038534 22.99246338 0.10268900</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Produce goodness of fit statistics and a qq plot</span></span>
<span><span class="va">gof.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.gof.html">ddf.gof</a></span><span class="op">(</span><span class="va">pi.mr.dist</span>, </span>
<span>                       main<span class="op">=</span><span class="st">"Point independence, trial configuration\n goodness of fit Golftee data"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:pit-nocovar"></span>
<img src="mrds-golftees_files/figure-html/pit-nocovar-1.png" alt="Point independence model in trial configuration goodness of fit."><p class="caption">
Figure 6: Point independence model in trial configuration goodness of fit.
</p>
</div>
<p>The AIC for this point independence model is 452.03 which is marginally smaller than the first full independence model that was fitted and hence is to be preferred.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get abundance estimates </span></span>
<span><span class="va">tee.abund.pi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dht.html">dht</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">pi.mr.dist</span>, region.table<span class="op">=</span><span class="va">region</span>,</span>
<span>                    sample.table<span class="op">=</span><span class="va">samples</span>, obs.table<span class="op">=</span><span class="va">obs</span><span class="op">)</span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tee.abund.pi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Abundance and density estimates from distance sampling</span></span>
<span><span class="co">## Variance       : R2, N/L </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary statistics</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Region Area CoveredArea Effort   n  k        ER      se.ER      cv.ER</span></span>
<span><span class="co">## 1      1 1040        1040    130  72  6 0.5538462 0.02926903 0.05284685</span></span>
<span><span class="co">## 2      2  640         640     80  52  5 0.6500000 0.08292740 0.12758061</span></span>
<span><span class="co">## 3  Total 1680        1680    210 124 11 0.5904762 0.03641856 0.06167659</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for clusters</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Abundance:</span></span>
<span><span class="co">##   Region  Estimate       se         cv       lcl      ucl        df</span></span>
<span><span class="co">## 1      1 130.00869 12.83042 0.09868894 106.66570 158.4601 48.427773</span></span>
<span><span class="co">## 2      2  93.89516 14.30894 0.15239268  66.25307 133.0701  8.094137</span></span>
<span><span class="co">## 3  Total 223.90385 23.21562 0.10368567 181.78333 275.7840 44.038262</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##   Region  Estimate         se         cv       lcl       ucl        df</span></span>
<span><span class="co">## 1      1 0.1250084 0.01233694 0.09868894 0.1025632 0.1523655 48.427773</span></span>
<span><span class="co">## 2      2 0.1467112 0.02235771 0.15239268 0.1035204 0.2079220  8.094137</span></span>
<span><span class="co">## 3  Total 0.1332761 0.01381882 0.10368567 0.1082044 0.1641571 44.038262</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for individuals</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Abundance:</span></span>
<span><span class="co">##   Region Estimate       se        cv      lcl      ucl        df</span></span>
<span><span class="co">## 1      1 413.4999 44.00744 0.1064267 332.9536 513.5313 30.289360</span></span>
<span><span class="co">## 2      2 274.4628 53.42626 0.1946576 171.1754 440.0740  5.987499</span></span>
<span><span class="co">## 3  Total 687.9626 79.79844 0.1159924 542.4532 872.5040 25.993175</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##   Region  Estimate         se        cv       lcl       ucl        df</span></span>
<span><span class="co">## 1      1 0.3975960 0.04231485 0.1064267 0.3201477 0.4937801 30.289360</span></span>
<span><span class="co">## 2      2 0.4288481 0.08347854 0.1946576 0.2674615 0.6876156  5.987499</span></span>
<span><span class="co">## 3  Total 0.4095016 0.04749907 0.1159924 0.3228888 0.5193476 25.993175</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Expected cluster size</span></span>
<span><span class="co">##   Region Expected.S se.Expected.S cv.Expected.S</span></span>
<span><span class="co">## 1      1   3.180556     0.2114629    0.06648615</span></span>
<span><span class="co">## 2      2   2.923077     0.1750319    0.05987935</span></span>
<span><span class="co">## 3  Total   3.072581     0.1391365    0.04528327</span></span></code></pre>
<p>This results in an estimated abundance of 688. Can we do better if more covariates are included in the DS model?</p>
<div class="section level5">
<h5 id="covariates-in-the-ds-model">Covariates in the DS model<a class="anchor" aria-label="anchor" href="#covariates-in-the-ds-model"></a>
</h5>
<p>To include covariates in the DS detection function, we need to specify an MCDS model as follows:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit the PI-trial model - DS sex and MR distance </span></span>
<span><span class="va">pi.mr.dist.ds.sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.html">ddf</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'trial'</span>, </span>
<span>                         mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'logit'</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">distance</span><span class="op">)</span>,</span>
<span>                         dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="../reference/mcds.html">mcds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">'hn'</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span>, </span>
<span>                         data<span class="op">=</span><span class="va">detections</span>, meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Use the <code>summary</code> function to check the AIC and decide if you are going to include any additional covariates in the detection function.</p>
<p>Now try a point independence model that has the preferred MR model from your full independence analyses.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Point independence model, Include covariates in DS model</span></span>
<span><span class="co"># Use selected MR model, iterate across DS models</span></span>
<span><span class="va">ds.formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~size"</span>,<span class="st">"~sex"</span>,<span class="st">"~exposure"</span>,<span class="st">"~size+sex"</span>,<span class="st">"~size+exposure"</span>,<span class="st">"~sex+exposure"</span>,</span>
<span>                <span class="st">"~size+sex+exposure"</span><span class="op">)</span></span>
<span><span class="va">num.ds.models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ds.formula</span><span class="op">)</span></span>
<span><span class="co"># Create dataframe to store results</span></span>
<span><span class="va">pi.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>DSmodel<span class="op">=</span><span class="va">ds.formula</span>, AIC<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">num.ds.models</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Loop through ds models - use selected MR model from earlier</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num.ds.models</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pi.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.html">ddf</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'trial'</span>, mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'logit'</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">distance</span><span class="op">+</span><span class="va">sex</span><span class="op">+</span><span class="va">exposure</span><span class="op">)</span>,</span>
<span>                  dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="../reference/mcds.html">mcds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">'hn'</span>,formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="va">ds.formula</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  data<span class="op">=</span><span class="va">detections</span>, meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">pi.results</span><span class="op">$</span><span class="va">AIC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pi.model</span><span class="op">)</span><span class="op">$</span><span class="va">AIC</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Calculate delta AIC</span></span>
<span><span class="va">pi.results</span><span class="op">$</span><span class="va">deltaAIC</span> <span class="op">&lt;-</span> <span class="va">pi.results</span><span class="op">$</span><span class="va">AIC</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">pi.results</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span></span>
<span><span class="co"># Order by delta AIC</span></span>
<span><span class="va">pi.results</span> <span class="op">&lt;-</span> <span class="va">pi.results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">pi.results</span><span class="op">$</span><span class="va">deltaAIC</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">pi.results</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">DSmodel</th>
<th align="right">AIC</th>
<th align="right">deltaAIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left">~sex</td>
<td align="right">399.26</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">~sex+exposure</td>
<td align="right">400.28</td>
<td align="right">1.02</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">~size+sex</td>
<td align="right">401.06</td>
<td align="right">1.80</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">~size+sex+exposure</td>
<td align="right">401.94</td>
<td align="right">2.69</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">~size</td>
<td align="right">407.92</td>
<td align="right">8.66</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">~exposure</td>
<td align="right">407.97</td>
<td align="right">8.72</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">~size+exposure</td>
<td align="right">409.89</td>
<td align="right">10.63</td>
</tr>
</tbody>
</table>
<p>This indicates that <code>sex</code> should be included in the DS model. We do this and check the goodness of fit and obtain abundance (Figure <a href="#fig:pidssex">7</a>).</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit chosen model</span></span>
<span><span class="va">pi.ds.sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddf.html">ddf</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'trial'</span>, mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'logit'</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">distance</span><span class="op">+</span><span class="va">sex</span><span class="op">+</span><span class="va">exposure</span><span class="op">)</span>,</span>
<span>                dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="../reference/mcds.html">mcds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">'hn'</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span>, data<span class="op">=</span><span class="va">detections</span>,  </span>
<span>                meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pi.ds.sex</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary for trial.fi object </span></span>
<span><span class="co">## Number of observations               :  162 </span></span>
<span><span class="co">## Number seen by primary               :  124 </span></span>
<span><span class="co">## Number seen by secondary (trials)    :  142 </span></span>
<span><span class="co">## Number seen by both (detected trials):  104 </span></span>
<span><span class="co">## AIC                                  :  94.89911 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Conditional detection function parameters:</span></span>
<span><span class="co">##               estimate        se</span></span>
<span><span class="co">## (Intercept)  0.7870962 0.6774633</span></span>
<span><span class="co">## distance    -1.9435496 0.3706866</span></span>
<span><span class="co">## sex1         2.8059863 0.6828331</span></span>
<span><span class="co">## exposure1    3.6094527 0.7332797</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                       Estimate         SE         CV</span></span>
<span><span class="co">## Average primary p(0) 0.9697357 0.02018875 0.02081882</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for ds object</span></span>
<span><span class="co">## Number of observations :  124 </span></span>
<span><span class="co">## Distance range         :  0  -  4 </span></span>
<span><span class="co">## AIC                    :  304.3594 </span></span>
<span><span class="co">## Optimisation           :  mrds (nlminb) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection function:</span></span>
<span><span class="co">##  Half-normal key function </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection function parameters </span></span>
<span><span class="co">## Scale coefficient(s): </span></span>
<span><span class="co">##              estimate        se</span></span>
<span><span class="co">## (Intercept) 0.2525377 0.1327279</span></span>
<span><span class="co">## sex1        0.5832341 0.2041094</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##            Estimate         SE        CV</span></span>
<span><span class="co">## Average p 0.5605421 0.04616356 0.0823552</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for trial object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Total AIC value =  399.2585 </span></span>
<span><span class="co">##                        Estimate          SE         CV</span></span>
<span><span class="co">## Average p             0.5435777  0.04643912 0.08543235</span></span>
<span><span class="co">## N in covered region 228.1182656 24.21303261 0.10614245</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check goodness-of-fit </span></span>
<span><span class="fu"><a href="../reference/ddf.gof.html">ddf.gof</a></span><span class="op">(</span><span class="va">pi.ds.sex</span>, main<span class="op">=</span><span class="st">"PI trial configutation\nGolfTee DS model sex"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:pidssex"></span>
<img src="mrds-golftees_files/figure-html/pidssex-1.png" alt="Goodness of fit of point independence model with sex covariate in the distance sampling component and distance, sex and exposure in the mr component."><p class="caption">
Figure 7: Goodness of fit of point independence model with sex covariate in the distance sampling component and distance, sex and exposure in the mr component.
</p>
</div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Goodness of fit results for ddf object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Chi-square tests</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling component:</span></span>
<span><span class="co">##           [0,0.4] (0.4,0.8] (0.8,1.2] (1.2,1.6] (1.6,2] (2,2.4] (2.4,2.8]</span></span>
<span><span class="co">## Observed   25.000    16.000    16.000    22.000   9.000  10.000    12.000</span></span>
<span><span class="co">## Expected   21.917    20.740    18.630    15.976  13.181  10.553     8.261</span></span>
<span><span class="co">## Chisquare   0.434     1.083     0.371     2.272   1.326   0.029     1.692</span></span>
<span><span class="co">##           (2.8,3.2] (3.2,3.6] (3.6,4]   Total</span></span>
<span><span class="co">## Observed      9.000     3.000   2.000 124.000</span></span>
<span><span class="co">## Expected      6.354     4.810   3.579 124.000</span></span>
<span><span class="co">## Chisquare     1.102     0.681   0.697   9.687</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## P = 0.20699 with 7 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mark-recapture component:</span></span>
<span><span class="co">## Capture History 01</span></span>
<span><span class="co">##           [0,0.4] (0.4,0.8] (0.8,1.2] (1.2,1.6] (1.6,2] (2,2.4] (2.4,2.8]</span></span>
<span><span class="co">## Observed        1         2         2         6       5       2         6</span></span>
<span><span class="co">## Expected        1         2         2         6       4       4         6</span></span>
<span><span class="co">## Chisquare       0         0         0         0       0       1         0</span></span>
<span><span class="co">##           (2.8,3.2] (3.2,3.6] (3.6,4] Total</span></span>
<span><span class="co">## Observed          6         2       6    38</span></span>
<span><span class="co">## Expected          7         2       5    38</span></span>
<span><span class="co">## Chisquare         0         0       0     2</span></span>
<span><span class="co">## Capture History 11</span></span>
<span><span class="co">##           [0,0.4] (0.4,0.8] (0.8,1.2] (1.2,1.6] (1.6,2] (2,2.4] (2.4,2.8]</span></span>
<span><span class="co">## Observed       21        15        16        20       8       8         9</span></span>
<span><span class="co">## Expected       21        15        16        20       9       6         9</span></span>
<span><span class="co">## Chisquare       0         0         0         0       0       1         0</span></span>
<span><span class="co">##           (2.8,3.2] (3.2,3.6] (3.6,4] Total</span></span>
<span><span class="co">## Observed          5         1       1   104</span></span>
<span><span class="co">## Expected          4         1       2   104</span></span>
<span><span class="co">## Chisquare         0         0       1     2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MR total chi-square = 3.3242  P = 0.76719 with 6 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Total chi-square = 13.012  P = 0.44692 with 13 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling Cramer-von Mises test (unweighted)</span></span>
<span><span class="co">## Test statistic = 0.081285 p-value = 0.684457</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get abundance estimates </span></span>
<span><span class="va">tee.abund.pi.ds.sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dht.html">dht</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">pi.ds.sex</span>, region.table<span class="op">=</span><span class="va">region</span>,</span>
<span>                    sample.table<span class="op">=</span><span class="va">samples</span>, obs.table<span class="op">=</span><span class="va">obs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tee.abund.pi.ds.sex</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Abundance and density estimates from distance sampling</span></span>
<span><span class="co">## Variance       : R2, N/L </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary statistics</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Region Area CoveredArea Effort   n  k        ER      se.ER      cv.ER</span></span>
<span><span class="co">## 1      1 1040        1040    130  72  6 0.5538462 0.02926903 0.05284685</span></span>
<span><span class="co">## 2      2  640         640     80  52  5 0.6500000 0.08292740 0.12758061</span></span>
<span><span class="co">## 3  Total 1680        1680    210 124 11 0.5904762 0.03641856 0.06167659</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for clusters</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Abundance:</span></span>
<span><span class="co">##   Region Estimate       se        cv       lcl      ucl        df</span></span>
<span><span class="co">## 1      1 125.7678 12.50301 0.0994134 102.97968 153.5987 43.661605</span></span>
<span><span class="co">## 2      2 102.3504 17.53164 0.1712904  68.75816 152.3544  7.394232</span></span>
<span><span class="co">## 3  Total 228.1183 25.15313 0.1102635 182.12587 285.7252 28.045408</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##   Region  Estimate         se        cv        lcl       ucl        df</span></span>
<span><span class="co">## 1      1 0.1209306 0.01202212 0.0994134 0.09901892 0.1476911 43.661605</span></span>
<span><span class="co">## 2      2 0.1599226 0.02739319 0.1712904 0.10743463 0.2380538  7.394232</span></span>
<span><span class="co">## 3  Total 0.1357847 0.01497210 0.1102635 0.10840826 0.1700745 28.045408</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary for individuals</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Abundance:</span></span>
<span><span class="co">##   Region Estimate       se         cv      lcl      ucl        df</span></span>
<span><span class="co">## 1      1 395.0545 36.33887 0.09198445 329.0893 474.2422 79.293122</span></span>
<span><span class="co">## 2      2 299.7763 65.43246 0.21827099 175.5600 511.8809  5.685162</span></span>
<span><span class="co">## 3  Total 694.8307 84.25522 0.12126006 537.2149 898.6902 15.167148</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##   Region  Estimate         se         cv       lcl       ucl        df</span></span>
<span><span class="co">## 1      1 0.3798601 0.03494122 0.09198445 0.3164320 0.4560021 79.293122</span></span>
<span><span class="co">## 2      2 0.4684004 0.10223822 0.21827099 0.2743125 0.7998140  5.685162</span></span>
<span><span class="co">## 3  Total 0.4135897 0.05015192 0.12126006 0.3197708 0.5349347 15.167148</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Expected cluster size</span></span>
<span><span class="co">##   Region Expected.S se.Expected.S cv.Expected.S</span></span>
<span><span class="co">## 1      1   3.141141     0.2081675    0.06627129</span></span>
<span><span class="co">## 2      2   2.928920     0.1866200    0.06371632</span></span>
<span><span class="co">## 3  Total   3.045923     0.1371508    0.04502767</span></span></code></pre>
<p>This model estimated an abundance of 695, which is closest to the true value of all the models - it is still less than the true value indicating, perhaps, some unmodelled heterogeneity on the trackline (or perhaps just bad luck - remember this was only one survey).</p>
<p>Was this complex modelling worthwhile? In this case, the estimated <span class="math inline">\(p(0)\)</span> for the best model was 0.97 (which is very close to 1). If we ran a conventional distance sampling analysis, pooling the data from the two observers, we should get a very robust estimate of true abundance.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Buckland2010" class="csl-entry">
Buckland, S. T., Laake, J. L., &amp; Borchers, D. L. (2010). Double-observer line transect methods: Levels of independence. <em>Biometrics</em>, <em>66</em>, 169–177. <a href="https://doi.org/10.1111/j.1541-0420.2009.01239.x" class="external-link">https://doi.org/10.1111/j.1541-0420.2009.01239.x</a>
</div>
<div id="ref-Laake-mrds" class="csl-entry">
Laake, J., Borchers, D., Thomas, L., Miller, D., &amp; Bishop, J. (2019). <em>Mrds: Mark-recapture distance sampling</em>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance</p>
</div>

    </footer>
</div>





  </body>
</html>
