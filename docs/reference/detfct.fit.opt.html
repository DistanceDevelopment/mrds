<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit detection function using key-adjustment functions — detfct.fit.opt • mrds</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit detection function using key-adjustment functions — detfct.fit.opt"><meta name="description" content="Fit detection function to observed distances using the key-adjustment
function approach. If adjustment functions are included it will alternate
between fitting parameters of key and adjustment functions and then all
parameters much like the approach in the CDS and MCDS Distance FORTRAN code.
This function is called by the driver function detfct.fit, it then
calls the relevant optimisation routine, slsqp,
solnp or optimx."><meta property="og:description" content="Fit detection function to observed distances using the key-adjustment
function approach. If adjustment functions are included it will alternate
between fitting parameters of key and adjustment functions and then all
parameters much like the approach in the CDS and MCDS Distance FORTRAN code.
This function is called by the driver function detfct.fit, it then
calls the relevant optimisation routine, slsqp,
solnp or optimx."><script type="text/javascript">(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)}; t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i; y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window, document, "clarity", "script", "m9r3j2v7dj");</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mrds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mrds-golftees.html">Point and full independence</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/mrds/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit detection function using key-adjustment functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/mrds/blob/HEAD/R/detfct.fit.opt.R" class="external-link"><code>R/detfct.fit.opt.R</code></a></small>
      <div class="d-none name"><code>detfct.fit.opt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit detection function to observed distances using the key-adjustment
function approach. If adjustment functions are included it will alternate
between fitting parameters of key and adjustment functions and then all
parameters much like the approach in the CDS and MCDS Distance FORTRAN code.
This function is called by the driver function <code>detfct.fit</code>, it then
calls the relevant optimisation routine, <code><a href="https://astamm.github.io/nloptr/reference/slsqp.html" class="external-link">slsqp</a></code>,
<code><a href="https://rdrr.io/pkg/Rsolnp/man/solnp.html" class="external-link">solnp</a></code> or <code><a href="https://rdrr.io/pkg/optimx/man/optimx.html" class="external-link">optimx</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detfct.fit.opt</span><span class="op">(</span><span class="va">ddfobj</span>, <span class="va">optim.options</span>, <span class="va">bounds</span>, <span class="va">misc.options</span>, fitting <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ddfobj">ddfobj<a class="anchor" aria-label="anchor" href="#arg-ddfobj"></a></dt>
<dd><p>detection function object</p></dd>


<dt id="arg-optim-options">optim.options<a class="anchor" aria-label="anchor" href="#arg-optim-options"></a></dt>
<dd><p>control options for optim</p></dd>


<dt id="arg-bounds">bounds<a class="anchor" aria-label="anchor" href="#arg-bounds"></a></dt>
<dd><p>bounds for the parameters</p></dd>


<dt id="arg-misc-options">misc.options<a class="anchor" aria-label="anchor" href="#arg-misc-options"></a></dt>
<dd><p>miscellaneous options</p></dd>


<dt id="arg-fitting">fitting<a class="anchor" aria-label="anchor" href="#arg-fitting"></a></dt>
<dd><p>character string with values "all","key","adjust" to
determine which parameters are allowed to vary in the fitting</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>fitted detection function model object with the following list
  structure</p>
<dl><dt>par</dt>
<dd><p>final parameter vector</p></dd>
 <dt>value</dt>
<dd><p>final negative
  log likelihood value</p></dd>
 <dt>counts</dt>
<dd><p>number of function evaluations</p></dd>

  <dt>convergence</dt>
<dd><p>see codes in optim</p></dd>
 <dt>message</dt>
<dd><p>string about
  convergence</p></dd>
 <dt>hessian</dt>
<dd><p>hessian evaluated at final parameter values</p></dd>

  <dt>aux</dt>
<dd><p>a list with 20 elements</p><ul><li><p>maxit: maximum number
  of iterations allowed for optimization</p></li>
<li><p>lower: lower bound values for
  parameters</p></li>
<li><p>upper: upper bound values for parameters</p></li>
<li><p>setlower:
  TRUE if they are user set bounds</p></li>
<li><p>setupper: TRUE if they are user set
  bounds</p></li>
<li><p>point: TRUE if point counts and FALSE if line transect</p></li>
<li><p>int.range: integration range values</p></li>
<li><p>showit: integer value that
  determines information printed during iteration</p></li>
<li><p>integral.numeric
  if TRUE compute logistic integrals numerically</p></li>
<li><p>breaks: breaks in distance for defined fixed bins for analysis</p></li>
<li><p>maxiter: maximum iterations used</p></li>
<li><p>refit: if TRUE, detection function
  will be fitted more than once if parameters are at a boundary or when
  convergence is not achieved</p></li>
<li><p>nrefits: number of refittings</p></li>
<li><p>mono: if TRUE, monotonicity will be enforced</p></li>
<li><p>mono.strict: if TRUE, then strict monotonicity is enforced; otherwise weak</p></li>
<li><p>width: radius of point count or half-width of strip</p></li>
<li><p>standardize: if TRUE, detection function is scaled so g(0)=1</p></li>
<li><p>ddfobj:
  distance detection function object; see <code><a href="create.ddfobj.html">create.ddfobj</a></code></p></li>
<li><p>bounded: TRUE if estimated parameters are at the bounds</p></li>
<li><p>model:
  list of formulas for detection function model (probably can remove this)</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dave Miller; Jeff Laake; Lorenzo Milazzo; Felix Petersma</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer></div>





  </body></html>

