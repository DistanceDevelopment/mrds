<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Distance Detection Function Fitting — ddf • mrds</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Distance Detection Function Fitting — ddf"><meta name="description" content="Generic function for fitting detection functions for distance sampling with
single and double observer configurations. Independent observer, trial and
dependent observer (removal) configurations are included. This is a generic
function which does little other than to validate the calling arguments and
methods and then calls the appropriate method specific function to do
the analysis."><meta property="og:description" content="Generic function for fitting detection functions for distance sampling with
single and double observer configurations. Independent observer, trial and
dependent observer (removal) configurations are included. This is a generic
function which does little other than to validate the calling arguments and
methods and then calls the appropriate method specific function to do
the analysis."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mrds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mrds-golftees.html">Point and full independence</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/mrds/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Distance Detection Function Fitting</h1>
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/mrds/blob/HEAD/R/ddf.R" class="external-link"><code>R/ddf.R</code></a></small>
      <div class="d-none name"><code>ddf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generic function for fitting detection functions for distance sampling with
single and double observer configurations. Independent observer, trial and
dependent observer (removal) configurations are included. This is a generic
function which does little other than to validate the calling arguments and
methods and then calls the appropriate <code>method</code> specific function to do
the analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ddf</span><span class="op">(</span></span>
<span>  dsmodel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mrmodel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ds"</span>,</span>
<span>  meta.data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  call <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dsmodel">dsmodel<a class="anchor" aria-label="anchor" href="#arg-dsmodel"></a></dt>
<dd><p>distance sampling model specification</p></dd>


<dt id="arg-mrmodel">mrmodel<a class="anchor" aria-label="anchor" href="#arg-mrmodel"></a></dt>
<dd><p>mark-recapture model specification</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>dataframe containing data to be analyzed</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>analysis method</p></dd>


<dt id="arg-meta-data">meta.data<a class="anchor" aria-label="anchor" href="#arg-meta-data"></a></dt>
<dd><p>list containing settings controlling data structure</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>list containing settings controlling model fitting</p></dd>


<dt id="arg-call">call<a class="anchor" aria-label="anchor" href="#arg-call"></a></dt>
<dd><p>not implemented for top level ddf function, this is set by ddf as it is passed to the other ddf generics.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>model object of class=(method, "ddf")</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The fitting code has certain expectations about <code>data</code>.  It should be a
dataframe with at least the following fields named and defined as follows:</p><table class="table table"><tr><td><code>object</code></td><td>object number</td></tr><tr><td><code>observer</code></td><td>observer number (1 or 2) for double
              observer; only 1 if single observer</td></tr><tr><td><code>detected</code></td><td>1 if detected by the observer and 0 if
              missed; always 1 for single observer</td></tr><tr><td><code>distance</code></td><td>perpendicular distance</td></tr></table><p>If the data are for clustered objects, the dataframe should also contain a
field named <code>size</code> that gives the observed number in the cluster. If
the data are for a double observer survey, then there are two records for
each observation and each should have the same object number. The code
assumes the observations are listed in the same order for each observer such
that if the data are subsetted by <code>observer</code> there will be the same
number of records in each and each subset will be in the same <code>object</code>
order. In addition to these predefined and pre-named fields, the dataframe
can have any number and type of fields that are used as covariates in the
<code>dsmodel</code> and <code>mrmodel</code>. At present, discrepancies between
observations in <code>distance</code>, <code>size</code> and any user-specified
covariates cannot be assimilated into the uncertainty of the estimate. The
code presumes the values for those fields are the same for both records
(observer=1 and observer=2) and it uses the value from observer 1. Thus it
makes sense to make the values the same for both records in each pair even
when both detect the object or when observer 1 doesn't detect the object the
data would have to be taken from observer 2 and would not be consistent.</p>
<p>Five different fitting methods are currently available and these in turn
define whether <code>dsmodel</code> and <code>mrmodel</code> need to be defined.</p>
<table class="table table"><tr><td>Method</td><td>Single/Double</td><td><code>dsmodel</code></td><td><code>mrmodel</code></td></tr><tr><td><code>ds</code></td><td>Single</td><td>yes</td><td>no</td></tr><tr><td><code>io</code></td><td>Double</td><td>yes</td><td>yes</td></tr><tr><td><code>io.fi</code></td><td>Double</td><td>no</td><td>yes</td></tr><tr><td><code>trial</code></td><td>Double</td><td>yes</td><td>yes</td></tr><tr><td><code>trial.fi</code></td><td>Double</td><td>no</td><td>yes</td></tr><tr><td><code>rem</code></td><td>Double</td><td>yes</td><td>yes</td></tr><tr><td><code>rem.fi</code></td><td>Double</td><td>no</td><td>yes</td></tr></table><p>Methods with the suffix "<code>.fi</code>" use the assumption of full independence
and do not use the distance sampling portion of the likelihood which is why a
<code>dsmodel</code> is not needed. An <code>mrmodel</code> is only needed for double
observer surveys and thus is not needed for method <code>ds</code>.</p>
<p>The <code>dsmodel</code> specifies the detection function g(y) for the distance
sampling data and the models restrict g(0)=1. For single observer data g(y)
is the detection function for the single observer and if it is a double
observer survey it is the relative detection function (assuming g(0)=1) of
both observers as a team (the unique observations from both observers). In
double observer surveys, the detection function is p(y)=p(0)g(y) such that
p(0)&lt;1.  The detection function g(y) is specified by <code>dsmodel</code> and p(0)
estimated from the conditional detection functions (see <code>mrmodel</code>
below).  The value of <code>dsmodel</code> is specified using a hybrid
formula/function notation.  The model definition is prefixed with a <code>~</code>
and the remainder is a function definition with specified arguments.  At
present there are two different functions, <code><a href="cds.html">cds</a></code> and
<code><a href="mcds.html">mcds</a></code>, for conventional distance sampling and multi-covariate
distance sampling.  Both functions have the same required arguments
(<code>key</code>,<code>formula</code>).  The first specifies the key function this
can be half-normal ("hn"), hazard-rate ("hr"), gamma ("gamma") or uniform
("unif"). The argument <code>formula</code> specifies the formula
for the log of the scale parameter of the key function (e.g., the equivalent
of the standard deviation in the half-normal).  The variable <code>distance</code>
should not be included in the formula because the scale is for distance.
See Marques, F.F.C. and S.T. Buckland (2004) for more details on the
representation of the scale formula. For the hazard rate and gamma
functions, an additional <code>shape.formula</code> can be specified for the model
of the shape parameter.  The default will be ~1.
Adjustment terms can be specified by setting <code>adj.series</code> which can have
the values: "none", "cos" (cosine), "poly" (polynomials), and "herm"
(Hermite polynomials). One must also specify a vector of orders for the
adjustment terms (<code>adj.order</code>) and a scaling (<code>adj.scale</code>) which
may be "width" or "scale" (for scaling by the scale parameter). Note that
the uniform key can only be used with adjustments (usually cosine adjustments
for a Fourier-type analysis).</p>
<p>The <code>mrmodel</code> specifies the form of the conditional detection functions
(i.e.,probability it is seen by observer j given it was seen by observer
3-j) for each observer (j=1,2) in a double observer survey.  The value is
specified using the same mix of formula/function notation but in this case
the functions are <code>glm</code> and <code>gam</code>.  The arguments for the
functions are <code>formula</code> and <code>link</code>.  At present, only <code>glm</code>
is allowed and it is restricted to <code>link=logit</code>.  Thus, currently the
only form for the conditional detection functions is logistic as expressed
in eq 6.32 of Laake and Borchers (2004).  In contrast to <code>dsmodel</code>, the
argument <code>formula</code> will typically include <code>distance</code> and all other
covariates that affect detection probability.  For example,
<code>mrmodel=~glm(formula=~distance+size+sex)</code> constructs a conditional
detection function based on the logistic form with additive factors,
distance, size, and sex.  As another example,
<code>mrmodel=~glm(formula=~distance*size+sex)</code> constructs the same model
with an added interaction between distance and size.</p>
<p>The argument <code>meta.data</code> is a list that enables various options about
the data to be set. These options include:</p>
<dl><dt><code>point</code></dt>
<dd><p>if <code>TRUE</code> the data are from point counts and
 <code>FALSE</code> (default) implies line transect data</p></dd>

 <dt><code>width</code></dt>
<dd><p>distance specifying half-width of the transect</p></dd>

 <dt><code>left</code></dt>
<dd><p>distance specifying inner truncation value</p></dd>

 <dt><code>binned</code></dt>
<dd><p><code>TRUE</code> or <code>FALSE</code> to specify whether
 distances should be binned for analysis</p></dd>

 <dt><code>breaks</code></dt>
<dd><p>if <code>binned=TRUE</code>, this is a required sequence of
 break points that are used for plotting/gof. They should match
 <code>distbegin</code>, <code>distend</code> values if bins are fixed</p></dd>

 <dt><code>int.range</code></dt>
<dd><p>an integration range for detection probability;
 either a vector of 2 or matrix with 2 columns</p></dd>

 <dt><code>mono</code></dt>
<dd><p>constrain the detection function to be weakly
 monotonically decreasing (only applicable when there are no covariates in
 the detection function)</p></dd>

 <dt><code>mono.strict</code></dt>
<dd><p>when <code>TRUE</code> constrain the detection function
 to be strictly monotonically decreasing (again, only applicable when there
 are no covariates in the detection function)</p></dd>


</dl><p>Using <code>meta.data=list(int.range=c(1,10))</code> is the same as
<code>meta.data=list(left=1,width=10)</code>. If
<code>meta.data=list(binned=TRUE)</code> is used, the dataframe needs to contain
the fields distbegin and distend for each observation which specify the left
and right hand end points of the distance interval containing the
observation. This is a general data structure that allows the intervals to
change rather than being fixed as in the standard distance analysis tools.
Typically, if the intervals are changing so is the integration range.  For
example, assume that distance bins are generated using fixed angular
measurements from an aircraft in which the altitude is varying.  Because all
analyses are truncated (i.e., the last interval does not go to infinity),
the transect width (and the left truncation point if there is a blindspot
below the aircraft) can potentially change for each observation. The
argument <code>int.range</code> can also be entered as a matrix with 2 columns
(left and width) and a row for each observation.</p>
<p>The argument <code>control</code> is a list that enables various analysis options
to be set.  It is not necessary to set any of these for most analyses.  They
were provided so the user can optionally see intermediate fitting output and
to control fitting if the algorithm doesn't converge which happens
infrequently.  The list values include:</p>
<dl><dt><code>showit</code></dt>
<dd><p>Integer (0-3, default 0) controls the
  (increasing)amount of information printed during fitting. 0 - none, &gt;=1 -
  information about refitting and bound changes is printed, &gt;=2 -
  information about adjustment term fitting is printed, ==3 -per-iteration
  parameter estimates and log-likelihood printed.</p></dd>

  <dt><code>estimate</code></dt>
<dd><p>if FALSE fits model but doesn't estimate predicted
  probabilities</p></dd>

  <dt><code>refit</code></dt>
<dd><p>if TRUE the algorithm will attempt multiple
  optimizations at different starting values if it doesn't converge</p></dd>

  <dt><code>nrefits</code></dt>
<dd><p>number of refitting attempts</p></dd>

  <dt><code>initial</code></dt>
<dd><p>a named list of starting values for the dsmodel
  parameters (e.g. <code>$scale</code>, <code>$shape</code>, <code>$adjustment</code>)</p></dd>

  <dt><code>lowerbounds</code></dt>
<dd><p>a vector of lowerbounds for the dsmodel
  parameters in the order the ds parameters will appear in the par
  element of the ddf object, i.e. <code>fit.ddf$par</code> where <code>fit.ddf</code>
  is a fitted ddf model.</p></dd>

  <dt><code>upperbounds</code></dt>
<dd><p>a vector of upperbounds for the dsmodel
  parameters in the order the ds parameters will appear in the par
  element of the ddf object, i.e. <code>fit.ddf$par</code> where <code>fit.ddf</code>
  is a fitted ddf model.</p></dd>

  <dt><code>limit</code></dt>
<dd><p>if TRUE restrict analysis to observations with
  <code>detected</code>=1</p></dd>

  <dt><code>debug</code></dt>
<dd><p>if TRUE, if fitting fails, return an object with
  fitting information</p></dd>

  <dt><code>nofit</code></dt>
<dd><p>if TRUE don't fit a model, but use the starting values
  and generate an object based on those values</p></dd>

  <dt><code>optimx.method</code></dt>
<dd><p>one (or a vector of) string(s) giving the
  optimisation method to use. If more than one is supplied, the results from
  one are used as the starting values for the next. See
  <code><a href="https://rdrr.io/pkg/optimx/man/optimx.html" class="external-link">optimx</a></code></p></dd>

  <dt><code>optimx.maxit</code></dt>
<dd><p>maximum number of iterations to use in the
  optimisation.</p></dd>

  <dt><code>mono.random.start</code></dt>
<dd><p>By default when monotonicity constraints
  are enforced, a grid of starting values are tested. Instead random
  starting values can be used (uniformly distributed between the upper and
  lower bounds). Set <code>TRUE</code> for random start, <code>FALSE</code> (default)
  uses the grid method</p></dd>

  <dt><code>mono.method</code></dt>
<dd><p>The optimiser method to be used when (strict)
  monotonicity is enforced. Can be either <code>slsqp</code> or <code>solnp</code>.
  Default <code>slsqp</code>.</p></dd>

  <dt><code>mono.startvals</code></dt>
<dd><p>Controls if the mono.optimiser should find
  better starting values by first fitting a key function without adjustments,
  and then use those start values for the key function parameters when
  fitting the key + adjustment series detection function. Defaults to
  <code>FALSE</code></p></dd>

  <dt><code>mono.outer.iter</code></dt>
<dd><p>Number of outer iterations to be used by
  <code>solnp</code> when fitting a monotonic model and <code>solnp</code> is selected.
  Default 200.</p></dd>

  <dt><code>silent</code></dt>
<dd><p>silences warnings within ds fitting method (helpful
  for running many times without generating many warning/error messages).</p></dd>

  <dt><code>optimizer</code></dt>
<dd><p>By default this is set to 'both' for single
  observer analyses and 'R' for double observer analyses. For single
  observer analyses where optimizer = 'both', the R optimizer will be used
  and if present the MCDS optimizer will also be used. The result with the
  best likelihood value will be selected. To run only a specified optimizer
  set this value to either 'R' or 'MCDS'. The MCDS optimizer cannot currently
  be used for detection function fitting with double observer analyses.
  See <code><a href="mcds_dot_exe.html">mcds_dot_exe</a></code> for more information.</p></dd>

  <dt><code>winebin</code></dt>
<dd><p>Location of the <code>wine</code> binary used to run
  <code>MCDS.exe</code>. See <a href="mcds_dot_exe.html">mcds_dot_exe</a> for more information.</p></dd>


</dl><p>Examples of distance sampling analyses are available at
<a href="https://examples.distancesampling.org/" class="external-link">https://examples.distancesampling.org/</a>.</p>
<p>Hints and tips on fitting (particularly optimisation issues) are on the
<code><a href="mrds_opt.html">mrds_opt</a></code> manual page.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Laake, J.L. and D.L. Borchers. 2004. Methods for incomplete
  detection at distance zero. In: Advanced Distance Sampling, eds. S.T.
  Buckland, D.R.Anderson, K.P. Burnham, J.L. Laake, D.L. Borchers, and L.
  Thomas. Oxford University Press.</p>
<p>Marques, F.F.C. and S.T. Buckland. 2004. Covariate models for the detection
  function. In: Advanced Distance Sampling, eds. S.T. Buckland,
  D.R.Anderson, K.P. Burnham, J.L. Laake, D.L. Borchers, and L. Thomas.
  Oxford University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ddf.ds.html">ddf.ds</a></code>, <code><a href="ddf.io.html">ddf.io</a></code>,
<code><a href="ddf.io.fi.html">ddf.io.fi</a></code>, <code><a href="ddf.trial.html">ddf.trial</a></code>,
<code><a href="ddf.trial.fi.html">ddf.trial.fi</a></code>, <code><a href="ddf.rem.html">ddf.rem</a></code>, <code><a href="ddf.rem.fi.html">ddf.rem.fi</a></code>,
<code><a href="mrds_opt.html">mrds_opt</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jeff Laake</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">book.tee.data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">region</span> <span class="op">&lt;-</span> <span class="va">book.tee.data</span><span class="op">$</span><span class="va">book.tee.region</span></span></span>
<span class="r-in"><span><span class="va">egdata</span> <span class="op">&lt;-</span> <span class="va">book.tee.data</span><span class="op">$</span><span class="va">book.tee.dataframe</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">book.tee.data</span><span class="op">$</span><span class="va">book.tee.samples</span></span></span>
<span class="r-in"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="va">book.tee.data</span><span class="op">$</span><span class="va">book.tee.obs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit a half-normal detection function</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">ddf</span><span class="op">(</span>dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="mcds.html">mcds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">"hn"</span>, formula<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span>, data<span class="op">=</span><span class="va">egdata</span>, method<span class="op">=</span><span class="st">"ds"</span>,</span></span>
<span class="r-in"><span>              meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit an independent observer model with full independence</span></span></span>
<span class="r-in"><span><span class="va">result.io.fi</span> <span class="op">&lt;-</span> <span class="fu">ddf</span><span class="op">(</span>mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="op">~</span><span class="va">distance</span><span class="op">)</span>, data<span class="op">=</span><span class="va">egdata</span>, method<span class="op">=</span><span class="st">"io.fi"</span>,</span></span>
<span class="r-in"><span>                    meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit an independent observer model with point independence</span></span></span>
<span class="r-in"><span><span class="va">result.io</span> <span class="op">&lt;-</span> <span class="fu">ddf</span><span class="op">(</span>dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="cds.html">cds</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"hn"</span><span class="op">)</span>, mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="op">~</span><span class="va">distance</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 data<span class="op">=</span><span class="va">egdata</span>, method<span class="op">=</span><span class="st">"io"</span>, meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulated single observer point count data (see ?ptdata.single)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ptdata.single</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ptdata.single</span><span class="op">$</span><span class="va">distbegin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ptdata.single</span><span class="op">$</span><span class="va">distance</span>,</span></span>
<span class="r-in"><span>                            <span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">ptdata.single</span><span class="op">$</span><span class="va">distend</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ptdata.single</span><span class="op">$</span><span class="va">distance</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">ddf</span><span class="op">(</span>data<span class="op">=</span><span class="va">ptdata.single</span>, dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="cds.html">cds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">"hn"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>point<span class="op">=</span><span class="cn">TRUE</span>,binned<span class="op">=</span><span class="cn">TRUE</span>,breaks<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,main<span class="op">=</span><span class="st">"Single observer binned point data - half normal"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">ddf</span><span class="op">(</span>data<span class="op">=</span><span class="va">ptdata.single</span>, dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="cds.html">cds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">"hr"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>point<span class="op">=</span><span class="cn">TRUE</span>, binned<span class="op">=</span><span class="cn">TRUE</span>, breaks<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, main<span class="op">=</span><span class="st">"Single observer binned point data - hazard rate"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulated double observer point count data (see ?ptdata.dual)</span></span></span>
<span class="r-in"><span><span class="co"># setup data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ptdata.dual</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ptdata.dual</span><span class="op">$</span><span class="va">distbegin</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ptdata.dual</span><span class="op">$</span><span class="va">distance</span>,</span></span>
<span class="r-in"><span>                          <span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">ptdata.dual</span><span class="op">$</span><span class="va">distend</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ptdata.dual</span><span class="op">$</span><span class="va">distance</span>,</span></span>
<span class="r-in"><span>                        <span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">ddf</span><span class="op">(</span>method<span class="op">=</span><span class="st">"io"</span>, data<span class="op">=</span><span class="va">ptdata.dual</span>, dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="cds.html">cds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">"hn"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula<span class="op">=</span><span class="op">~</span><span class="va">distance</span><span class="op">*</span><span class="va">observer</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>point<span class="op">=</span><span class="cn">TRUE</span>, binned<span class="op">=</span><span class="cn">TRUE</span>, breaks<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, main<span class="op">=</span><span class="st">"Dual observer binned point data"</span>, new<span class="op">=</span><span class="cn">FALSE</span>, pages<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">ddf</span><span class="op">(</span>method<span class="op">=</span><span class="st">"io"</span>, data<span class="op">=</span><span class="va">ptdata.dual</span>,</span></span>
<span class="r-in"><span>             dsmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="cds.html">cds</a></span><span class="op">(</span>key<span class="op">=</span><span class="st">"unif"</span>, adj.series<span class="op">=</span><span class="st">"cos"</span>, adj.order<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             mrmodel<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula<span class="op">=</span><span class="op">~</span><span class="va">distance</span><span class="op">*</span><span class="va">observer</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>point<span class="op">=</span><span class="cn">TRUE</span>, binned<span class="op">=</span><span class="cn">TRUE</span>, breaks<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,main<span class="op">=</span><span class="st">"Dual observer binned point data"</span>,new<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer></div>





  </body></html>

