<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Various functions used to specify key and adjustment functions for
detection functions."><title>Detection functions — distpdf • mrds</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detection functions — distpdf"><meta property="og:description" content="Various functions used to specify key and adjustment functions for
detection functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mrds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mrds-golftees.html">Point and full independence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DistanceDevelopment/mrds/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Detection functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/mrds/blob/HEAD/R/detfct.R" class="external-link"><code>R/detfct.R</code></a></small>
      <div class="d-none name"><code>distpdf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Various functions used to specify key and adjustment functions for
detection functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detfct</span><span class="op">(</span><span class="va">distance</span>, <span class="va">ddfobj</span>, select<span class="op">=</span><span class="cn">NULL</span>, index<span class="op">=</span><span class="cn">NULL</span>, width<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>              standardize <span class="op">=</span> <span class="cn">TRUE</span>, stdint<span class="op">=</span><span class="cn">FALSE</span>, left<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">adjfct.cos</span><span class="op">(</span><span class="va">distance</span>, scaling <span class="op">=</span> <span class="fl">1</span>, <span class="va">adj.order</span>, adj.parm <span class="op">=</span> <span class="cn">NULL</span>, adj.exp<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">adjfct.poly</span><span class="op">(</span><span class="va">distance</span>, scaling <span class="op">=</span> <span class="fl">1</span>, <span class="va">adj.order</span>, adj.parm <span class="op">=</span> <span class="cn">NULL</span>, adj.exp<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">adjfct.herm</span><span class="op">(</span><span class="va">distance</span>, scaling <span class="op">=</span> <span class="fl">1</span>, <span class="va">adj.order</span>, adj.parm <span class="op">=</span> <span class="cn">NULL</span>, adj.exp<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scalevalue</span><span class="op">(</span><span class="va">key.scale</span>, <span class="va">z</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">keyfct.hn</span><span class="op">(</span><span class="va">distance</span>, <span class="va">key.scale</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">keyfct.hz</span><span class="op">(</span><span class="va">distance</span>, <span class="va">key.scale</span>, <span class="va">key.shape</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">keyfct.gamma</span><span class="op">(</span><span class="va">distance</span>, <span class="va">key.scale</span>, <span class="va">key.shape</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fx</span><span class="op">(</span><span class="va">distance</span>,<span class="va">ddfobj</span>,select<span class="op">=</span><span class="cn">NULL</span>,index<span class="op">=</span><span class="cn">NULL</span>,width<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>   standardize<span class="op">=</span><span class="cn">TRUE</span>,stdint<span class="op">=</span><span class="cn">FALSE</span>, left<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fr</span><span class="op">(</span><span class="va">distance</span>,<span class="va">ddfobj</span>,select<span class="op">=</span><span class="cn">NULL</span>,index<span class="op">=</span><span class="cn">NULL</span>,width<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>   standardize<span class="op">=</span><span class="cn">TRUE</span>,stdint<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">distpdf</span><span class="op">(</span><span class="va">distance</span>,<span class="va">ddfobj</span>,select<span class="op">=</span><span class="cn">NULL</span>,index<span class="op">=</span><span class="cn">NULL</span>,width<span class="op">=</span><span class="cn">NULL</span>,standardize<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>           stdint<span class="op">=</span><span class="cn">FALSE</span>,point<span class="op">=</span><span class="cn">FALSE</span>, left<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>distance</dt>
<dd><p>vector of distances</p></dd>


<dt>ddfobj</dt>
<dd><p>distance sampling object (see <code><a href="create.ddfobj.html">create.ddfobj</a></code>)</p></dd>


<dt>select</dt>
<dd><p>logical vector for selection of data values</p></dd>


<dt>index</dt>
<dd><p>specific data row index</p></dd>


<dt>width</dt>
<dd><p>(right) truncation width</p></dd>


<dt>standardize</dt>
<dd><p>logical used to decide whether to divide through by the
function evaluated at 0</p></dd>


<dt>stdint</dt>
<dd><p>logical used to decide whether integral is standardized</p></dd>


<dt>point</dt>
<dd><p>if TRUE, point counts; otherwise line transects</p></dd>


<dt>left</dt>
<dd><p>(left) truncation distance</p></dd>


<dt>z</dt>
<dd><p>design matrix for scale function</p></dd>


<dt>key.scale</dt>
<dd><p>vector of scale values</p></dd>


<dt>key.shape</dt>
<dd><p>vector of shape values</p></dd>


<dt>adj.order</dt>
<dd><p>vector of adjustment orders</p></dd>


<dt>adj.parm</dt>
<dd><p>vector of adjustment parameters</p></dd>


<dt>scaling</dt>
<dd><p>the scaling for the adjustment terms</p></dd>


<dt>adj.exp</dt>
<dd><p>if TRUE uses exp(adj) for adjustment to keep f(x)&gt;0</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For <code>detfct</code>, the value is a vector of detection probabilities
For <code>keyfct.*</code>, vector of key function evaluations
For <code>adjfct.*</code>, vector of adjustment series evaluations
For <code>scalevalue</code>, vector of the scale parameters.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Multi-covariate detection functions (MCDS) are represented by a function
\(g(x,w,\theta)\) where x is distance, z is a set of covariates and
\(\theta\) is the parameter vector.  The functions are defined such that
\(g(0,w,\theta)=1\) and the covariates modify the scale \((x/\sigma)\)
where a log link is used to relate \(\sigma\) to the covariates,
\(\sigma=exp(\theta*w)\). A CDS function is obtained with a constant
\(\sigma\) which is equivalent to an intercept  design matrix, z.</p>
<p><code>detfct</code> will call either a gamma, half-normal, hazard-rate or uniform
function only returning the probability of detection at that distance. In
addition to the simple model above, we may specify adjustment terms to fit
the data better. These adjustments are either Cosine, Hermite and simple
polynomials. These are specified as arguments to <code>detfct</code>, as detailed
below.</p>
<p><code>detfct</code> function which calls the others and assembles the final result
using either key(x)[1+series(x)] or
(key(x)[1+series(x)])/(key(0)[1+series(0)]) (depending on the value of
<code>standardize</code>).</p>
<p><code>keyfct.*</code> functions calculate key function values and <code>adjfct.*</code>
calculate adjustment term values.</p>
<p><code>scalevalue</code> for either detection function it computes the scale with
the log link using the parameters and the covariate design matrix</p>
<p><code>fx</code>, <code>fr</code> non-normalized probability density for line transects
and point counts respectively</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Marques, F. F. C., &amp; Buckland, S. T. (2003). Incorporating covariates into
standard line transect analyses. Biometrics, 59(4), 924-935.</p>
<p>Buckland, S. T., Anderson, D. R., Burnham, K. P., Laake, J. L., Borchers, D.
L., &amp; Thomas, L. (2004). Advanced Distance Sampling. Oxford University
Press, Oxford, UK.</p>
<p>Becker, E. F. and P. X. Quang. 2009. A gamma-shaped detection function for
line transect surveys with mark-recapture and covariate data. Journal of
Agricultural Biological and Environmental Statistics 14:207-223.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mcds.html">mcds</a></code>,  <code><a href="cds.html">cds</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jeff Laake, David L Miller</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance</p>
</div>

    </footer></div>

  

  

  </body></html>

