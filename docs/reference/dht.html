<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Density and abundance estimates and variances — dht • mrds</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Density and abundance estimates and variances — dht"><meta name="description" content="Compute density and abundance estimates and variances based on
Horvitz-Thompson-like estimator."><meta property="og:description" content="Compute density and abundance estimates and variances based on
Horvitz-Thompson-like estimator."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mrds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mrds-golftees.html">Point and full independence</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/mrds/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Density and abundance estimates and variances</h1>
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/mrds/blob/HEAD/R/dht.R" class="external-link"><code>R/dht.R</code></a></small>
      <div class="d-none name"><code>dht.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute density and abundance estimates and variances based on
Horvitz-Thompson-like estimator.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dht</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">region.table</span>,</span>
<span>  <span class="va">sample.table</span>,</span>
<span>  obs.table <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>ddf model object</p></dd>


<dt id="arg-region-table">region.table<a class="anchor" aria-label="anchor" href="#arg-region-table"></a></dt>
<dd><p><code>data.frame</code> of region records. Two columns:
<code>Region.Label</code> and <code>Area</code>. If only density is required, one can
set <code>Area=0</code> for all regions.</p></dd>


<dt id="arg-sample-table">sample.table<a class="anchor" aria-label="anchor" href="#arg-sample-table"></a></dt>
<dd><p><code>data.frame</code> of sample records. Three columns:
<code>Region.Label</code>, <code>Sample.Label</code>, <code>Effort</code>.</p></dd>


<dt id="arg-obs-table">obs.table<a class="anchor" aria-label="anchor" href="#arg-obs-table"></a></dt>
<dd><p><code>data.frame</code> of observation records with fields:
<code>object</code>, <code>Region.Label</code>, and <code>Sample.Label</code> which give links
to <code>sample.table</code>, <code>region.table</code> and the data records used in
<code>model</code>. Not necessary if the <code>data.frame</code> used to create the
model contains <code>Region.Label</code>, <code>Sample.Label</code> columns.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>subset statement to create <code>obs.table</code></p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>if <code>TRUE</code> computes standard errors, coefficient of variation
and confidence intervals (based on log-normal approximation). See
"Uncertainty" below.</p></dd>


<dt id="arg-options">options<a class="anchor" aria-label="anchor" href="#arg-options"></a></dt>
<dd><p>a list of options that can be set, see "<code>dht</code> options",
below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>list object of class <code>dht</code> with elements:</p>
<dl><dt>clusters</dt>
<dd><p>result list for object clusters</p></dd>

<dt>individuals</dt>
<dd><p>result list for individuals</p></dd>

<dt>Expected.S</dt>
<dd><p><code>data.frame</code> of estimates of expected cluster size
 with fields <code>Region</code>, <code>Expected.S</code> and <code>se.Expected.S</code>
 If each cluster <code>size=1</code>, then the result only includes individuals
 and not clusters and <code>Expected.S</code>.</p></dd>


</dl><p>The list structure of clusters and individuals are the same:</p>
<dl><dt>bysample</dt>
<dd><p><code>data.frame</code> giving results for each sample;
<code>Nchat</code> is the estimated abundance within the sample and <code>Nhat</code> is
scaled by surveyed area/covered area within that region</p></dd>

<dt>summary</dt>
<dd><p><code>data.frame</code> of summary statistics for each region and
total</p></dd>

<dt>N</dt>
<dd><p><code>data.frame</code> of estimates of abundance for each region and
total</p></dd>

<dt>D</dt>
<dd><p><code>data.frame</code> of estimates of density for each region and total</p></dd>

<dt>average.p</dt>
<dd><p>average detection probability estimate</p></dd>

<dt>cormat</dt>
<dd><p>correlation matrix of regional abundance/density estimates and
total (if more than one region)</p></dd>

<dt>vc</dt>
<dd><p>list of 3: total variance-covariance matrix, detection function
component of variance and encounter rate component of variance. For
detection the v-c matrix and partial vector are returned</p></dd>

<dt>Nhat.by.sample</dt>
<dd><p>another summary of <code>Nhat</code> by sample used by
<code><a href="dht.se.html">dht.se</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Density and abundance within the sampled region is computed based on a
Horvitz-Thompson-like estimator for groups and individuals (if a clustered
population) and this is extrapolated to the entire survey region based on
any defined regional stratification. The variance is based on replicate
samples within any regional stratification. For clustered populations,
\(E(s)\) and its standard error are also output.</p>
<p>Abundance is estimated with a Horvitz-Thompson-like estimator (Huggins 1989,
1991; Borchers et al 1998; Borchers and Burnham 2004). The abundance in the
sampled region is simply \(1/p_1 + 1/p_2 + ... + 1/p_n\) where \(p_i\)
is the estimated detection probability for the \(i\)th detection of
\(n\) total observations. It is not strictly a Horvitz-Thompson estimator
because the \(p_i\) are estimated and not known. For animals observed in
tight clusters, that estimator gives the abundance of groups
(<code>group=TRUE</code> in <code>options</code>) and the abundance of individuals is
estimated as \(s_1/p_1 + s_2/p_2 + ... + s_n/p_n\), where \(s_i\) is the
size (e.g., number of animals in the group) of each observation
(<code>group=FALSE</code> in <code>options</code>).</p>
<p>Extrapolation and estimation of abundance to the entire survey region is
based on either a random sampling design or a stratified random sampling
design. Replicate samples (lines) are specified within regional strata
<code>region.table</code>, if any. If there is no stratification,
<code>region.table</code> should contain only a single record with the <code>Area</code>
for the entire survey region. The <code>sample.table</code> is linked to the
<code>region.table</code> with the <code>Region.Label</code>. The <code>obs.table</code> is
linked to the <code>sample.table</code> with the <code>Sample.Label</code> and
<code>Region.Label</code>. Abundance can be restricted to a subset (e.g., for a
particular species) of the population by limiting the list the observations
in <code>obs.table</code> to those in the desired subset. Alternatively, if
<code>Sample.Label</code> and <code>Region.Label</code> are in the <code>data.frame</code>
used to fit the model, then a <code>subset</code> argument can be given in place
of the <code>obs.table</code>. To use the <code>subset</code> argument but include all
of the observations, use <code>subset=1==1</code> to avoid creating an
<code>obs.table</code>.</p>
<p>In extrapolating to the entire survey region it is important that the unit
measurements be consistent or converted for consistency. A conversion factor
can be specified with the <code>convert.units</code> variable in the
<code>options</code> list. The values of <code>Area</code> in <code>region.table</code>, must
be made consistent with the units for <code>Effort</code> in <code>sample.table</code>
and the units of <code>distance</code> in the <code>data.frame</code> that was analyzed.
It is easiest to do if the units of <code>Area</code> is the square of the units
of <code>Effort</code> and then it is only necessary to convert the units of
<code>distance</code> to the units of <code>Effort</code>. For example, if <code>Effort</code>
was entered in kilometres and <code>Area</code> in square kilometres and
<code>distance</code> in metres then using
<code>options=list(convert.units=0.001)</code> would convert metres to kilometres,
density would be expressed in square kilometres which would then be
consistent with units for <code>Area</code>. However, they can all be in different
units as long as the appropriate composite value for <code>convert.units</code> is
chosen. Abundance for a survey region can be expressed as: <code>A*N/a</code>
where <code>A</code> is <code>Area</code> for the survey region, <code>N</code> is the
abundance in the covered (sampled) region, and <code>a</code> is the area of the
sampled region and is in units of <code>Effort * distance</code>. The sampled
region <code>a</code> is multiplied by <code>convert.units</code>, so it should be
chosen such that the result is in the same units of <code>Area</code>. For
example, if <code>Effort</code> was entered in kilometres, <code>Area</code> in hectares
(100m x 100m) and <code>distance</code> in metres, then using
<code>options=list(convert.units=10)</code> will convert <code>a</code> to units of
hectares (100 to convert metres to 100 metres for distance and .1 to convert
km to 100m units).</p>
<p>The argument <code>options</code> is a list of <code>variable=value</code> pairs that
set options for the analysis. All but two of these have been described above.
<code>pdelta</code> should not need to be changed but was included for
completeness. It controls the precision of the first derivative calculation
for the delta method variance. If the option <code>areas.supplied</code> is
<code>TRUE</code> then the covered area is assumed to be supplied in the
<code>CoveredArea</code> column of the sample <code>data.frame</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="uncertainty">Uncertainty<a class="anchor" aria-label="anchor" href="#uncertainty"></a></h2>


<p>If the argument <code>se=TRUE</code>, standard errors for density and abundance is
computed. Coefficient of variation and log-normal confidence intervals are
constructed using a Satterthwaite approximation for degrees of freedom
(Buckland et al. 2001 p. 90). The function <code><a href="dht.se.html">dht.se</a></code> computes the
variance and interval estimates.</p>
<p>The variance has two components:</p><ul><li><p>variation due to uncertainty from estimation of the detection
  function parameters;</p></li>
<li><p>variation in abundance due to random sample selection;</p></li>
</ul><p>The first component (model parameter uncertainty) is computed using a delta
method estimate of variance (Huggins 1989, 1991, Borchers et al. 1998) in
which the first derivatives of the abundance estimator with respect to the
parameters in the detection function are computed numerically (see
<code><a href="DeltaMethod.html">DeltaMethod</a></code>).</p>
<p>The second component (encounter rate variance) can be computed in one of
several ways depending on the form taken for the encounter rate and the
estimator used. To begin with there three possible values for <code>varflag</code>
to calculate encounter rate:</p><ul><li><p><code>0</code> uses a binomial variance for the number of observations
 (equation 13 of Borchers et al. 1998). This estimator is only useful if the
 sampled region is the survey region and the objects are not clustered; this
 situation will not occur very often;</p></li>
<li><p><code>1</code> uses the encounter rate \(n/L\) (objects observed per unit
 transect) from Buckland et al. (2001) pg 78-79 (equation 3.78) for line
 transects (see also Fewster et al, 2009 estimator R2). This variance
 estimator is not appropriate if <code>size</code> or a derivative of <code>size</code>
 is used in the detection function;</p></li>
<li><p><code>2</code> is the default and uses the encounter rate estimator
 \(\hat{N}/L\) (estimated abundance per unit transect) suggested by Innes
 et al (2002) and Marques &amp; Buckland (2004).</p></li>
</ul><p>In general if any covariates are used in the models, the default
<code>varflag=2</code> is preferable as the estimated abundance will take into
account variability due to covariate effects. If the population is clustered
the mean group size and standard error is also reported.</p>
<p>For options <code>1</code> and <code>2</code>, it is then possible to choose one of the
estimator forms given in Fewster et al (2009) for line transects:
<code>"R2"</code>, <code>"R3"</code>, <code>"R4"</code>, <code>"S1"</code>, <code>"S2"</code>,
<code>"O1"</code>, <code>"O2"</code> or <code>"O3"</code> by specifying the <code>ervar=</code>
option (default <code>"R2"</code>). For points, either the <code>"P2"</code> or
<code>"P3"</code> estimator can be selected (&gt;=mrds 2.3.0 default <code>"P2"</code>,
&lt;= mrds 2.2.9 default <code>"P3"</code>). See <code><a href="varn.html">varn</a></code> and Fewster
et al (2009) for further details on these estimators.</p>
    </div>
    <div class="section level2">
    <h2 id="dht-options"><code>dht</code> options<a class="anchor" aria-label="anchor" href="#dht-options"></a></h2>


<p>Several options are available to control calculations and output:</p>
<dl><dt><code>ci.width</code></dt>
<dd><p>Confidence interval width, expressed as a decimal
 between 0 and 1 (default <code>0.95</code>, giving a 95% CI)</p></dd>

 <dt><code>pdelta</code></dt>
<dd><p>delta value for computing numerical first derivatives
 (Default: 0.001)</p></dd>

 <dt><code>varflag</code></dt>
<dd><p>0,1,2 (see "Uncertainty") (Default: <code>2</code>)</p></dd>

 <dt><code>convert.units</code></dt>
<dd><p>multiplier for width to convert to units of
 length (Default: <code>1</code>)</p></dd>

 <dt><code>ervar</code></dt>
<dd><p>encounter rate variance type (see "Uncertainty" and
 <code>type</code> argument of <code><a href="varn.html">varn</a></code>). (Default: <code>"R2"</code> for
 lines and <code>"P2"</code> for points)</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Borchers, D.L., S.T. Buckland, P.W. Goedhart, E.D. Clarke, and S.L. Hedley.
  1998. Horvitz-Thompson estimators for double-platform line transect
  surveys. Biometrics 54: 1221-1237.</p>
<p>Borchers, D.L. and K.P. Burnham. General formulation for distance sampling
  pp 10-11 In: Advanced Distance Sampling, eds. S.T. Buckland, D.R.Anderson,
  K.P. Burnham, J.L. Laake, D.L. Borchers, and L. Thomas. Oxford University
  Press.</p>
<p>Buckland, S.T., D.R.Anderson, K.P. Burnham, J.L. Laake, D.L. Borchers, and
  L. Thomas. 2001. Introduction to Distance Sampling: Estimating Abundance
  of Biological Populations. Oxford University Press.</p>
<p>Fewster, R.M., S.T. Buckland, K.P. Burnham, D.L. Borchers, P.E. Jupp, J.L.
  Laake and L. Thomas. 2009. Estimating the encounter rate variance in
  distance sampling. Biometrics 65: 225-236.</p>
<p>Huggins, R.M. 1989. On the statistical analysis of capture experiments.
  Biometrika 76:133-140.</p>
<p>Huggins, R.M. 1991. Some practical aspects of a conditional likelihood
  approach to capture experiments. Biometrics 47: 725-732.</p>
<p>Innes, S., M.P. Heide-Jorgensen, J.L. Laake, K.L. Laidre, H.J. Cleator, P.
  Richard, and R.E.A. Stewart. 2002. Surveys of belugas and narwhals in the
  Canadian High Arctic in 1996. NAMMCO Scientific Publications 4: 169-190.</p>
<p>Marques, F.F.C. and S.T. Buckland. 2004. Covariate models for the detection
  function. In: Advanced Distance Sampling, eds. S.T. Buckland,
  D.R.Anderson, K.P. Burnham, J.L. Laake, D.L. Borchers, and L. Thomas.
  Oxford University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>print.dht dht.se</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jeff Laake, David L Miller</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer></div>





  </body></html>

